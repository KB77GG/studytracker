<view class="container">
  <!-- 背景装饰 -->
  <view class="bg-circle-1"></view>
  <view class="bg-circle-2"></view>

  <!-- 品牌区域 -->
  <view class="brand-area">
    <image class="brand-logo" src="/images/logo.jpg" mode="widthFix"></image>
    <text class="slogan">让每一次进步都看得见</text>
  </view>

  <!-- 主卡片区域 -->
  <view class="main-card">
    
    <!-- 1. 登录引导 -->
    <view class="login-section" wx:if="{{!hasToken}}">
      <view class="welcome-text">
        <text class="h1">欢迎回来</text>
        <text class="p">请登录以继续您的学习之旅</text>
      </view>
      <button class="btn-primary" bindtap="handleLogin">
        <text class="wechat-icon">💬</text> 微信一键登录
      </button>
    </view>

    <!-- 2. 角色选择 -->
    <view class="role-section" wx:if="{{hasToken && isGuest}}">
      <text class="section-title">请选择您的身份</text>
      <view class="role-grid">
        <view class="role-item student" bindtap="selectRole" data-role="student">
          <view class="role-icon-bg">🎓</view>
          <text class="role-label">我是学生</text>
          <text class="role-desc">查看任务 · 提交打卡</text>
        </view>
        <view class="role-item parent" bindtap="selectRole" data-role="parent">
          <view class="role-icon-bg">👨‍👩‍👧</view>
          <text class="role-label">我是家长</text>
          <text class="role-desc">关注成长 · 查看报告</text>
        </view>
      </view>
    </view>

    <!-- 3. 绑定表单 -->
    <view class="bind-section" wx:if="{{showBindForm}}">
      <text class="section-title">完善信息</text>
      <text class="section-subtitle">绑定{{targetRole === 'student' ? '学生' : '家长'}}身份以开始使用</text>
      
      <view class="input-group">
        <text class="input-label">姓名</text>
        <input class="input-field" placeholder="请输入真实姓名" model:value="{{bindName}}" />
      </view>
      
      <view class="input-group" wx:if="{{targetRole === 'parent'}}">
        <text class="input-label">手机号</text>
        <input class="input-field" type="number" placeholder="请输入手机号码" model:value="{{bindPhone}}" />
      </view>

      <view class="action-buttons">
        <button class="btn-cancel" bindtap="cancelBind">取消</button>
        <button class="btn-confirm" bindtap="confirmBind">确认绑定</button>
      </view>
    </view>

  </view>

  <!-- Debug 按钮 (保持在底部) -->
  <view class="debug-area">
    <text class="debug-link" bindtap="handleDebugUnbind">解除绑定 (Debug)</text>
  </view>
</view>
