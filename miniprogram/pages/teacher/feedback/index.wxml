<view class="container">
  <view class="header">
    <text class="title">上课反馈</text>
    <text class="subtitle">{{schedule.schedule_date || ''}}</text>
  </view>

  <view class="card">
    <view class="info-row">
      <text class="label">课程</text>
      <text class="value">{{schedule.course_name || '—'}}</text>
    </view>
    <view class="info-row">
      <text class="label">时间</text>
      <text class="value">{{schedule.start_time || '—'}} {{schedule.end_time ? ('- ' + schedule.end_time) : ''}}</text>
    </view>
    <view class="info-row">
      <text class="label">学生</text>
      <text class="value">{{schedule.student_name || '—'}}</text>
    </view>
    <view class="info-row">
      <text class="label">老师</text>
      <text class="value">{{schedule.teacher_name || '—'}}</text>
    </view>
  </view>

  <view class="form">
    <text class="form-label">作业完成情况</text>
    <textarea
      class="textarea section-textarea"
      placeholder="填写作业完成度、准确率、存在的问题"
      maxlength="200"
      value="{{feedbackForm.homeworkStatus}}"
      data-field="homeworkStatus"
      bindinput="handleSectionInput"
    ></textarea>
    <view class="counter">{{feedbackForm.homeworkStatus.length}}/200</view>
  </view>

  <view class="form">
    <text class="form-label">课堂表现及问题</text>
    <textarea
      class="textarea section-textarea"
      placeholder="填写课堂专注度、互动表现、关键问题"
      maxlength="240"
      value="{{feedbackForm.classPerformance}}"
      data-field="classPerformance"
      bindinput="handleSectionInput"
    ></textarea>
    <view class="counter">{{feedbackForm.classPerformance.length}}/240</view>
  </view>

  <view class="form">
    <text class="form-label">建议及作业</text>
    <textarea
      class="textarea section-textarea"
      placeholder="填写课后建议与下次课前作业安排"
      maxlength="200"
      value="{{feedbackForm.suggestionHomework}}"
      data-field="suggestionHomework"
      bindinput="handleSectionInput"
    ></textarea>
    <view class="counter">{{feedbackForm.suggestionHomework.length}}/200</view>
  </view>

  <view class="form">
    <view class="image-header">
      <text class="form-label">反馈图片</text>
      <text class="image-tip">可选</text>
    </view>
    <view class="image-uploader">
      <view class="image-preview" wx:if="{{feedbackImage}}">
        <image class="preview-img" src="{{imagePreviewUrl}}" mode="aspectFill" bindtap="previewImage"></image>
        <button class="remove-btn" size="mini" bindtap="removeImage">删除</button>
      </view>
      <button class="upload-btn" size="mini" loading="{{uploadingImage}}" disabled="{{uploadingImage}}" bindtap="chooseImage">
        {{feedbackImage ? '更换图片' : '添加图片'}}
      </button>
    </view>
  </view>

  <button class="submit-btn" loading="{{saving}}" disabled="{{saving}}" bindtap="submitFeedback">
    提交反馈
  </button>
</view>
