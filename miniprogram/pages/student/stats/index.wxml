<view class="container">
  <!-- 访客模式提示条 -->
  <view class="guest-banner" wx:if="{{isGuest}}">
    <text class="guest-text">访客模式浏览中 · 登录查看学习数据</text>
    <view class="guest-login-btn" bindtap="goLogin">登录</view>
  </view>
  <!-- 头部用户信息 -->
  <view class="header">
    <view class="user-info">
      <view class="avatar">S</view>
      <view class="info-text">
        <text class="username">我的学习档案</text>
        <text class="level">Lv.{{stats.level || 1}} 学习者</text>
      </view>
    </view>
  </view>

  <!-- 核心数据卡片 -->
  <view class="stats-grid">
    <view class="stat-card fire">
      <view class="icon-dot fire"></view>
      <view class="value">{{stats.streak || 0}}</view>
      <view class="label">连续打卡(天)</view>
    </view>
    <view class="stat-card time">
      <view class="icon-dot time"></view>
      <view class="value">{{stats.total_hours || 0}}</view>
      <view class="label">累计学习(小时)</view>
    </view>
  </view>

  <!-- 本周趋势 -->
  <view class="section">
    <view class="section-title">本周学习趋势</view>
    <view class="chart-container">
      <view class="bar-group" wx:for="{{stats.weekly_activity}}" wx:key="date">
        <view class="bar-wrapper">
          <view class="bar" style="height: {{item.count * 24 + 16}}rpx; max-height: 260rpx;"></view>
        </view>
        <text class="day-label">{{item.day_label}}</text>
      </view>
    </view>
  </view>

  <!-- 勋章墙 -->
  <view class="section">
    <view class="section-title">我的勋章</view>
    <scroll-view scroll-x="true" class="badge-strip">
      <view class="badge-item" wx:for="{{stats.badges}}" wx:key="id">
        <view class="badge-icon">{{item.icon}}</view>
        <text class="badge-name">{{item.name}}</text>
        <text class="badge-desc">{{item.desc}}</text>
      </view>
    </scroll-view>
  </view>

  <!-- 账号管理 -->
  <view class="logout-section">
    <button class="btn-unbind" bindtap="handleUnbind">解除微信绑定 (Debug)</button>
    <button class="btn-logout" bindtap="handleLogout">退出登录</button>
  </view>
</view>
