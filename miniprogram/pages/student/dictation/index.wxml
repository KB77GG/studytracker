<!--å¬å†™ç»ƒä¹ é¡µé¢ - ç¿ç„¶å“ç‰Œé£æ ¼-->
<view class="container" wx:if="{{!loading && !completed}}">
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <view class="header">
    <view class="header-left">
      <text class="logo">ç¿ç„¶</text>
      <text class="chapter">{{bookTitle}}</text>
    </view>
    <view class="accent-toggle">
      <view class="accent-btn {{accent === 'uk' ? 'active' : ''}}" bindtap="switchAccent" data-accent="uk">ğŸ‡¬ğŸ‡§</view>
      <view class="accent-btn {{accent === 'us' ? 'active' : ''}}" bindtap="switchAccent" data-accent="us">ğŸ‡ºğŸ‡¸</view>
    </view>
  </view>

  <!-- ç»ƒä¹ ä¸»ä½“ -->
  <view class="practice-area">
    <text class="prompt-text">æ ¹æ®å‘éŸ³å†™å‡ºå•è¯</text>
    
    <view class="input-area">
      <input 
        class="word-input" 
        placeholder="è¾“å…¥å•è¯"
        value="{{userAnswer}}"
        bindinput="onInput"
        bindconfirm="submitAnswer"
        confirm-type="done"
        focus="{{inputFocus}}"
        adjust-position="{{true}}"
      />
      <view class="submit-btn" bindtap="submitAnswer">æäº¤</view>
    </view>

    <view class="play-btn {{isPlaying ? 'playing' : ''}}" bindtap="playAudio">
      <text class="play-icon-text">ğŸ”Š</text>
    </view>
  </view>

  <!-- è¿›åº¦æ¡ -->
  <view class="progress-area">
    <view class="progress-bar">
      <view class="progress-fill" style="width: {{progress}}%"></view>
    </view>
    <text class="progress-text">{{currentIndex + 1}}/{{totalWords}}</text>
  </view>
</view>

<!-- ç­”é¢˜ç»“æœå¼¹çª— -->
<view class="result-overlay" wx:if="{{showResult}}" bindtap="nextWord">
  <view class="result-card" catchtap="stopPropagation">
    <text class="result-icon {{isCorrect ? 'correct' : 'wrong'}}">
      {{isCorrect ? 'âœ“' : 'âœ—'}}
    </text>
    <text class="result-word">{{currentWord.word}}</text>
    <text class="result-phonetic">{{currentWord.phonetic || ''}}</text>
    <text class="result-translation">{{currentWord.translation || ''}}</text>
    <text class="result-your-answer" wx:if="{{!isCorrect}}">
      ä½ çš„ç­”æ¡ˆ: {{userAnswer}}
    </text>
    <view class="next-btn" bindtap="nextWord">
      {{currentIndex + 1 >= totalWords ? 'æŸ¥çœ‹æˆç»©' : 'ä¸‹ä¸€é¢˜'}}
    </view>
  </view>
</view>

<!-- å®Œæˆé¡µé¢ -->
<view class="complete-page" wx:if="{{completed}}">
  <text class="complete-icon">ğŸ‰</text>
  <text class="complete-title">ç»ƒä¹ å®Œæˆï¼</text>
  
  <view class="stats-card">
    <view class="stat-row">
      <text class="stat-label">æ€»é¢˜æ•°</text>
      <text class="stat-value">{{totalWords}}</text>
    </view>
    <view class="stat-row">
      <text class="stat-label">æ­£ç¡®</text>
      <text class="stat-value" style="color: #4caf50;">{{correctCount}}</text>
    </view>
    <view class="stat-row">
      <text class="stat-label">é”™è¯¯</text>
      <text class="stat-value" style="color: #f44336;">{{totalWords - correctCount}}</text>
    </view>
    <view class="stat-row">
      <text class="stat-label">æ­£ç¡®ç‡</text>
      <text class="stat-value accuracy">{{accuracy}}%</text>
    </view>
  </view>

  <view class="action-btns">
    <view class="action-btn secondary" bindtap="restartPractice">é‡æ–°ç»ƒä¹ </view>
    <view class="action-btn primary" bindtap="goBack">è¿”å›</view>
  </view>
</view>

<!-- åŠ è½½ä¸­ -->
<view class="loading" wx:if="{{loading}}">
  <view class="weui-loading"></view>
  <text class="loading-text">åŠ è½½ä¸­...</text>
</view>
